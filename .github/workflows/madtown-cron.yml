# .github/workflows/madtown-cron.yml
name: MADTOWN CLIPS Cron Jobs

on:
  schedule:
    # 🎥 新着動画取得（6時間ごと）
    - cron: "0 */6 * * *"

    # 🎞️ ショート動画判定（3時間ごと）
    - cron: "15 */3 * * *"

    # 📊 再生数・高評価更新（毎時）
    - cron: "30 * * * *"

    # 🧹 削除チェック（6時間ごと）
    - cron: "0 */6 * * *"

  workflow_dispatch: # 手動実行も可能

jobs:
  run-crons:
    runs-on: ubuntu-latest

    steps:
      - name: 🔍 Fetch Videos Diff（6時間ごと）
        run: |
          echo "Running fetch-videos-diff..."
          curl -s -o /dev/null -w "%{http_code}\n" https://madtown-clips.vercel.app/api/fetch-videos-diff

      - name: 🧩 Update Shorts（3時間ごと）
        run: |
          echo "Running update-is-short-html..."
          curl -s -o /dev/null -w "%{http_code}\n" https://madtown-clips.vercel.app/api/update-is-short-html

      - name: 📊 Update Stats（毎時）
        run: |
          echo "Running update-stats..."
          curl -s -o /dev/null -w "%{http_code}\n" https://madtown-clips.vercel.app/api/update-stats

      - name: 🧹 Cleanup Deleted Videos（6時間ごと）
        run: |
          echo "Running cleanup-deleted-videos..."
          curl -s -o /dev/null -w "%{http_code}\n" https://madtown-clips.vercel.app/api/cleanup-deleted-videos
