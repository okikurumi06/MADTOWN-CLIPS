name: MADTOWN CLIPS Cron Jobs (Balanced Optimized)

on:
  schedule:
    # ğŸ¥ æ–°ç€å‹•ç”»å–å¾—ï¼ˆ12æ™‚é–“ã”ã¨ï¼‰
    - cron: "0 */12 * * *"

    # ğŸ·ï¸ ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°æ¤œç´¢ï¼ˆ1æ—¥1å›ï¼‰
    - cron: "30 9 * * *"

    # ğŸ§© ã‚·ãƒ§ãƒ¼ãƒˆå‹•ç”»åˆ¤å®šï¼ˆæ¯æ™‚ï¼‰
    - cron: "0 * * * *"

    # ğŸ“Š å†ç”Ÿæ•°ãƒ»é«˜è©•ä¾¡æ›´æ–°ï¼ˆ2æ™‚é–“ã”ã¨ï¼‰
    - cron: "0 */2 * * *"

    # ğŸ§¹ å‰Šé™¤ãƒã‚§ãƒƒã‚¯ï¼ˆæ¯æ—¥æ—©æœ3æ™‚ï¼‰
    - cron: "0 3 * * *"

  workflow_dispatch: # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯

jobs:
  run-crons:
    runs-on: ubuntu-latest

    steps:
      # ===============================
      # ğŸ¥ æ–°ç€å‹•ç”»å–å¾—ï¼ˆ12æ™‚é–“ã”ã¨ï¼‰
      # ===============================
      - name: ğŸ¥ Fetch Videos Diff Batch 1ï¼ˆ12æ™‚é–“ã”ã¨ï¼‰
        run: |
          echo "Running fetch-videos-diff (Batch 1)..."
          curl -s -o /dev/null -w "%{http_code}\n" "https://madtown-clips.vercel.app/api/fetch-videos-diff?offset=0&limit=50"

      - name: ğŸ¥ Fetch Videos Diff Batch 2
        run: |
          echo "Running fetch-videos-diff (Batch 2)..."
          curl -s -o /dev/null -w "%{http_code}\n" "https://madtown-clips.vercel.app/api/fetch-videos-diff?offset=50&limit=50"

      - name: ğŸ¥ Fetch Videos Diff Batch 3
        run: |
          echo "Running fetch-videos-diff (Batch 3)..."
          curl -s -o /dev/null -w "%{http_code}\n" "https://madtown-clips.vercel.app/api/fetch-videos-diff?offset=100&limit=50"

      - name: ğŸ¥ Fetch Videos Diff Batch 4
        run: |
          echo "Running fetch-videos-diff (Batch 4)..."
          curl -s -o /dev/null -w "%{http_code}\n" "https://madtown-clips.vercel.app/api/fetch-videos-diff?offset=150&limit=50"

      # ===============================
      # ğŸ·ï¸ ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°æ¤œç´¢ï¼ˆ1æ—¥1å›ï¼‰
      # ===============================
      - name: ğŸ·ï¸ Fetch Videos by Hashtagï¼ˆ1æ—¥1å›ï¼‰
        run: |
          echo "Running fetch-videos-hashtag..."
          curl -s -o /dev/null -w "%{http_code}\n" "https://madtown-clips.vercel.app/api/fetch-videos-hashtag"

      # ===============================
      # ğŸ§© ã‚·ãƒ§ãƒ¼ãƒˆå‹•ç”»åˆ¤å®šï¼ˆæ¯æ™‚ï¼‰
      # ===============================
      - name: ğŸ§© Update Shortsï¼ˆæ¯æ™‚ï¼‰
        run: |
          echo "Running update-is-short-html..."
          curl -s -o /dev/null -w "%{http_code}\n" "https://madtown-clips.vercel.app/api/update-is-short-html"

      # ===============================
      # ğŸ“Š å†ç”Ÿæ•°ãƒ»é«˜è©•ä¾¡æ›´æ–°ï¼ˆ2æ™‚é–“ã”ã¨ï¼‰
      # ===============================
      - name: ğŸ“Š Update Statsï¼ˆ2æ™‚é–“ã”ã¨ï¼‰
        run: |
          echo "Running update-stats..."
          curl -s -o /dev/null -w "%{http_code}\n" "https://madtown-clips.vercel.app/api/update-stats"

      # ===============================
      # ğŸ§¹ å‰Šé™¤ãƒã‚§ãƒƒã‚¯ï¼ˆæ¯æ—¥1å›ï¼‰
      # ===============================
      - name: ğŸ§¹ Cleanup Deleted Videosï¼ˆæ¯æ—¥3æ™‚ï¼‰
        run: |
          echo "Running cleanup-deleted-videos..."
          curl -s -o /dev/null -w "%{http_code}\n" "https://madtown-clips.vercel.app/api/cleanup-deleted-videos"
